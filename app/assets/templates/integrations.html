<div ng-controller="IntegrationsController" class="row">
  <div class="boxed-header">
    <div class="large-2 small-12 columns">
      <h4><a ng-href="/#/integrations">Integrations</a></h4>
    </div>
  </div>

  <div class="small-12 columns">
    <div class="row">
      <div class="small-12 large-12 columns panel">

        <div ng-repeat="(type, service) in integrationTypes">
          <h4 class="subheader">{{service.name}}</h4>
          <div class='panel contentpanel' ng-repeat="integration in service.integrations">
            <a href="" ng-click="remove(integration.id, service)" class="secondary button right tiny">Remove</a>
            <div class="row">
              <div class="small-2 columns"><strong>API key:</strong></div>
              <div class="small-10 columns">{{integration.api_key}}</div>
            </div>
          </div>
          <form ng-submit='add(type, service)'>
            <div id="{{type}}_form" class="panel contentpanel integration-form" ng-show="service.addFormShown">
              <a ng-click="openAddForm(service)" class="tiny button secondary right-align"><span class="subheader">Close</span></a>
              <h5 class="subheader">Add a new integration</h5>

              <tabset>
                <tab heading="Credentials">
                  <div class="small-12 large-6 columns">
                    <div>
                      <label>Username or email:
                        <input name="username" type="text" id="username" name="username" ng-model="service.newIntegration.username" />
                        <small ng-show="service.errors.username" class="error">{{service.errors.username}}</small>
                      </label>
                      <label>Password:
                        <input name="password" type="password" ng-model="service.newIntegration.password" />
                        <small ng-show="service.errors.password" class="error">{{service.errors.password}}</small>
                      </label>
                    </div>
                  </div>
                  <div class="hide-for-small large-6 columns panel">
                    <p class="subheader">Sign in with your credentials in order to get projects and stories information from
                    your {{service.name}} account via API.<br/><br/>
                    You can also provide a valid API token under API Key tab.</p>
                  </div>
                </tab>
                <tab heading="API Key">
                  <div class="small-12 large-6 columns">
                    <div>
                      <label>API key:
                        <input name="token" type="text" ng-model="service.newIntegration.api_key" />
                        <small ng-show="service.errors.api_key" class="error">{{service.errors.api_key}}</small>
                      </label>
                    </div>
                  </div>
                  <div class="hide-for-small large-6 columns panel">
                    <p class="subheader">Get access to the information of your projects and stories from {{service.name}} providing a valid {{service.token_name}}.<br/><br/>
                    You can check your {{service.token_name}}s or create a new one going to {{service.name}},
                    under <a href="{{service.api_section_url}}" target="_blank">{{service.api_section}}</a> section.</p>
                  </div>
                </tab>
              </tabset>
              <br/>
              <button class="button right-align small">Add new integration</button>
            </div>
          </form>
          <a href="" id="add_new_{{type}}" ng-show="!service.addFormShown" ng-click="openAddForm(service)" class="button secondary small right">Add new integration</a><br/>
        </div>
      </div>
    </div>
  </div>
</div>

